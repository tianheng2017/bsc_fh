import{V as L,y as U,J as M,K as j,x as z,t as G,A as H,j as l}from"./element-plus.69fcf893.js";import{P as J}from"./index.1377612b.js";import{r as g}from"./index.01c230e9.js";import{d as K,s as v,$,r as k,o as f,c as _,U as s,L as a,S as d,T as y,a as p,R as E}from"./@vue.230e89ba.js";function me(i){return g.get({url:"/withdraw/lists",params:i})}function O(i){return g.post({url:"/withdraw/audit",params:i})}function fe(i){return g.post({url:"/withdraw/delete",params:i})}const Q={class:"edit-popup"},X=d("\u62D2\u7EDD"),Y=d("\u901A\u8FC7"),Z={key:0},ee={class:"flex-1"},ue={key:1},te={class:"flex-1"},oe=d("\u70B9\u51FB\u8F6C\u8D26"),se=p("div",{class:"form-tips"}," \u672C\u6B65\u9AA4\u4E3A\u53EF\u9009\u64CD\u4F5C\uFF0C\u70B9\u51FB\u540E\u5C06\u5524\u8D77metamask\u8FDB\u884C\u7B7E\u540D\u8F6C\u8D26\uFF0C\u82E5\u60A8\u5DF2\u7ECF\u5728\u7EBF\u4E0B\u5B8C\u6210\u8F6C\u8D26\uFF0C\u8BF7\u76F4\u63A5\u70B9\u51FB\u53F3\u4E0B\u89D2\u201C\u786E\u5B9A\u201D\u6309\u94AE\u5373\u53EF\u3002 ",-1),ae={key:2},re={class:"flex-1"},_e=K({__name:"audit",emits:["success"],setup(i,{expose:A,emit:x}){const F=v(),D=v(),o=$({id:0,status:2,remark:"",amount:0,address:""}),m=k(!1),h=k(!1),b={status:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA1\u6838\u7ED3\u679C",trigger:"blur"}],remark:[{validator:(e,u,t)=>{u===""||o.status!==2?t(new Error("\u8BF7\u8F93\u5165\u62D2\u7EDD\u7406\u7531")):t()},trigger:"blur"}]},V=async()=>{var u,t;await((u=F.value)==null?void 0:u.validate());const e={...o};await O(e),(t=D.value)==null||t.close(),x("success")},R=()=>{var e;(e=D.value)==null||e.open()},I=()=>{var e;(e=F.value)==null||e.resetFields()},S=e=>{for(const u in o)e[u]!=null&&e[u]!=null&&(o[u]=e[u])},T=async()=>typeof window.ethereum>"u"?-1:(window.ethereum.on("accountsChanged",function(e){window.location.reload()}),window.ethereum.chainId!==56&&window.ethereum.networkVersion!=="56"?-2:window.ethereum.isHbWallet?window.ethereum.address:(await window.ethereum.request({method:"eth_requestAccounts"}))[0]),q=e=>{let u=0,t="";return e==-1?t="\u8BF7\u5728Dapp\u6D4F\u89C8\u5668\u73AF\u5883\u6253\u5F00":e==-2?t="\u8BF7\u5207\u6362\u5230BSC\u94FE":e==null?t="\u8BF7\u89E3\u9501\u94B1\u5305":u=1,{code:u,msg:t}};async function N(e,u){const t=await T(),n=q(t),c=localStorage.getItem("transfer_time")||!1;if(c&&parseInt(new Date().getTime())/1e3-parseInt(c)<20)return l.error("\u8F6C\u8D26\u9700\u95F4\u969420\u79D2");if(!n.code)return l.error(n.msg);if(e<=0)return l.error("\u8F6C\u8D26\u91D1\u989D\u5FC5\u987B\u5927\u4E8E0");const w=await window.ethereum.request({method:"eth_gasPrice"}),C=await window.ethereum.request({method:"eth_getTransactionCount",params:[t,"pending"]});window.ethereum.request({method:"eth_sendTransaction",params:[{from:t,to:u,gasPrice:w.toString(),gas:"0x7a120",nonce:C.toString(),value:(e*10**18).toString(16),chainId:"0x38"}]}).then(r=>{if(console.log("\u7ED3\u679C\uFF1A"+r),r=="null")return l.error("\u64CD\u4F5C\u5931\u8D25\uFF0C\u4F59\u989D\u4E0D\u8DB3");h.value=r,l.success("\u4EA4\u6613\u5DF2\u5E7F\u64AD\uFF0C\u7B49\u5F85\u533A\u5757\u6253\u5305"),localStorage.setItem("transfer_time",parseInt(new Date().getTime()/1e3))}).catch(r=>(console.log("err:"+r),l.error("\u64CD\u4F5C\u5DF2\u53D6\u6D88")))}const P=async()=>{try{m.value=!0,await N(o.amount,o.address),m.value=!1}catch(e){return console.log(o),l.error(e.message)}finally{m.value=!1}};return A({open:R,setFormData:S}),(e,u)=>{const t=L,n=U,c=M,w=j,C=z,r=G,W=H;return f(),_("div",Q,[s(J,{ref_key:"popupRef",ref:D,title:"\u63D0\u73B0\u5BA1\u6838",async:!0,width:"550px",clickModalClose:!1,onConfirm:V,onClose:I},{default:a(()=>[s(W,{ref_key:"formRef",ref:F,model:o,"label-width":"120px",rules:b},{default:a(()=>[s(n,{label:"\u63D0\u73B0\u6570\u91CF",prop:"amount"},{default:a(()=>[s(t,{underline:!1},{default:a(()=>[d(y(o.amount+" BNB"),1)]),_:1})]),_:1}),s(n,{label:"\u5BA1\u6838\u7ED3\u679C",prop:"status"},{default:a(()=>[s(w,{modelValue:o.status,"onUpdate:modelValue":u[0]||(u[0]=B=>o.status=B)},{default:a(()=>[s(c,{label:2},{default:a(()=>[X]),_:1}),s(c,{label:1},{default:a(()=>[Y]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.status==2?(f(),_("div",Z,[s(n,{label:"\u62D2\u7EDD\u7406\u7531",prop:"remark"},{default:a(()=>[p("div",ee,[s(C,{type:"textarea",rows:"5",modelValue:o.remark,"onUpdate:modelValue":u[1]||(u[1]=B=>o.remark=B),placeholder:"\u8BF7\u8F93\u5165\u62D2\u7EDD\u7406\u7531\uFF0C\u62D2\u7EDD\u65F6\u5FC5\u586B","show-word-limit":""},null,8,["modelValue"])])]),_:1})])):E("",!0),o.status==1?(f(),_("div",ue,[s(n,{label:"\u53D1\u8D77\u8F6C\u8D26"},{default:a(()=>[p("div",te,[s(r,{type:"success",size:"small",onClick:P,loading:m.value},{default:a(()=>[oe]),_:1},8,["loading"]),se])]),_:1})])):E("",!0),h.value?(f(),_("div",ae,[s(n,{label:"Tx"},{default:a(()=>[p("div",re,[s(r,{type:"primary",link:""},{default:a(()=>[d(y(h.value),1)]),_:1})])]),_:1})])):E("",!0)]),_:1},8,["model"])]),_:1},512)])}}});export{_e as _,fe as a,me as b};
