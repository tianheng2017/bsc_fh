import{r as $}from"./parse-asn1.a331a1f8.js";import{b as C}from"./randombytes.926bd932.js";import{r as L}from"./create-hash.0f02e375.js";import{s as y}from"./safe-buffer.d5a81f77.js";import{b as R}from"./bn.js.92292d6f.js";import{r as z}from"./browserify-rsa.97901e9a.js";var B={},k,S;function I(){if(S)return k;S=1;var l=L(),u=y.exports.Buffer;k=function(f,c){for(var h=u.alloc(0),m=0,d;h.length<c;)d=v(m++),h=u.concat([h,l("sha1").update(f).update(d).digest()]);return h.slice(0,c)};function v(f){var c=u.allocUnsafe(4);return c.writeUInt32BE(f,0),c}return k}var q,N;function Z(){return N||(N=1,q=function(u,v){for(var f=u.length,c=-1;++c<f;)u[c]^=v[c];return u}),q}var x,U;function _(){if(U)return x;U=1;var l=R.exports,u=y.exports.Buffer;function v(f,c){return u.from(f.toRed(l.mont(c.modulus)).redPow(new l(c.publicExponent)).fromRed().toArray())}return x=v,x}var P,A;function F(){if(A)return P;A=1;var l=$(),u=C.exports,v=L(),f=I(),c=Z(),h=R.exports,m=_(),d=z(),s=y.exports.Buffer;P=function(i,n,r){var e;i.padding?e=i.padding:r?e=1:e=4;var a=l(i),o;if(e===4)o=b(a,n);else if(e===1)o=E(a,n,r);else if(e===3){if(o=new h(n),o.cmp(a.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return r?d(o,a):m(o,a)};function b(t,i){var n=t.modulus.byteLength(),r=i.length,e=v("sha1").update(s.alloc(0)).digest(),a=e.length,o=2*a;if(r>n-o-2)throw new Error("message too long");var w=s.alloc(n-r-o-2),g=n-a-1,H=u(a),M=c(s.concat([e,w,s.alloc(1,1),i],g),f(H,g)),j=c(H,f(M,a));return new h(s.concat([s.alloc(1),j,M],n))}function E(t,i,n){var r=i.length,e=t.modulus.byteLength();if(r>e-11)throw new Error("message too long");var a;return n?a=s.alloc(e-r-3,255):a=p(e-r-3),new h(s.concat([s.from([0,n?1:2]),a,s.alloc(1),i],e))}function p(t){for(var i=s.allocUnsafe(t),n=0,r=u(t*2),e=0,a;n<t;)e===r.length&&(r=u(t*2),e=0),a=r[e++],a&&(i[n++]=a);return i}return P}var D,W;function G(){if(W)return D;W=1;var l=$(),u=I(),v=Z(),f=R.exports,c=z(),h=L(),m=_(),d=y.exports.Buffer;D=function(t,i,n){var r;t.padding?r=t.padding:n?r=1:r=4;var e=l(t),a=e.modulus.byteLength();if(i.length>a||new f(i).cmp(e.modulus)>=0)throw new Error("decryption error");var o;n?o=m(new f(i),e):o=c(i,e);var w=d.alloc(a-o.length);if(o=d.concat([w,o],a),r===4)return s(e,o);if(r===1)return b(e,o,n);if(r===3)return o;throw new Error("unknown padding")};function s(p,t){var i=p.modulus.byteLength(),n=h("sha1").update(d.alloc(0)).digest(),r=n.length;if(t[0]!==0)throw new Error("decryption error");var e=t.slice(1,r+1),a=t.slice(r+1),o=v(e,u(a,r)),w=v(a,u(o,i-r-1));if(E(n,w.slice(0,r)))throw new Error("decryption error");for(var g=r;w[g]===0;)g++;if(w[g++]!==1)throw new Error("decryption error");return w.slice(g)}function b(p,t,i){for(var n=t.slice(0,2),r=2,e=0;t[r++]!==0;)if(r>=t.length){e++;break}var a=t.slice(2,r-1);if((n.toString("hex")!=="0002"&&!i||n.toString("hex")!=="0001"&&i)&&e++,a.length<8&&e++,e)throw new Error("decryption error");return t.slice(r)}function E(p,t){p=d.from(p),t=d.from(t);var i=0,n=p.length;p.length!==t.length&&(i++,n=Math.min(p.length,t.length));for(var r=-1;++r<n;)i+=p[r]^t[r];return i}return D}var X;function K(){return X||(X=1,function(l){l.publicEncrypt=F(),l.privateDecrypt=G(),l.privateEncrypt=function(v,f){return l.publicEncrypt(v,f,!0)},l.publicDecrypt=function(v,f){return l.privateDecrypt(v,f,!0)}}(B)),B}export{K as r};
