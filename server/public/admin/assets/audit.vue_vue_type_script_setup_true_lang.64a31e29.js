var J=Object.defineProperty;var V=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var R=(s,r,t)=>r in s?J(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,I=(s,r)=>{for(var t in r||(r={}))K.call(r,t)&&R(s,t,r[t]);if(V)for(var t of V(r))$.call(r,t)&&R(s,t,r[t]);return s};var h=(s,r,t)=>new Promise((F,f)=>{var o=i=>{try{D(t.next(i))}catch(B){f(B)}},p=i=>{try{D(t.throw(i))}catch(B){f(B)}},D=i=>i.done?F(i.value):Promise.resolve(i.value).then(o,p);D((t=t.apply(s,r)).next())});import{V as O,y as Q,J as X,K as Y,x as Z,t as ee,A as ue,j as m}from"./element-plus.2d443847.js";import{P as te}from"./index.89655f46.js";import{r as b,u as oe}from"./index.a71cd9d1.js";import{l as S}from"./web3.d361188c.js";import{d as se,s as T,$ as ae,r as P,o as g,c as v,U as n,L as l,S as C,T as W,a as k,R as x}from"./@vue.230e89ba.js";function ve(s){return b.get({url:"/withdraw/lists",params:s})}function re(s){return b.post({url:"/withdraw/audit",params:s})}function ke(s){return b.post({url:"/withdraw/delete",params:s})}const ne={class:"edit-popup"},le=C("\u62D2\u7EDD"),ie=C("\u901A\u8FC7"),ce={key:0},de={class:"flex-1"},me={key:1},fe={class:"flex-1"},pe=C("\u70B9\u51FB\u8F6C\u8D26"),_e=k("div",{class:"form-tips"}," \u672C\u6B65\u9AA4\u4E3A\u53EF\u9009\u64CD\u4F5C\uFF0C\u70B9\u51FB\u540E\u5C06\u5524\u8D77metamask\u8FDB\u884C\u7B7E\u540D\u8F6C\u8D26\uFF0C\u82E5\u60A8\u5DF2\u7ECF\u5728\u7EBF\u4E0B\u5B8C\u6210\u8F6C\u8D26\uFF0C\u8BF7\u76F4\u63A5\u70B9\u51FB\u53F3\u4E0B\u89D2\u201C\u786E\u5B9A\u201D\u6309\u94AE\u5373\u53EF\u3002 ",-1),Fe={key:2},De={class:"flex-1"},Ae=se({__name:"audit",emits:["success"],setup(s,{expose:r,emit:t}){const F=T(),f=T(),o=ae({id:0,status:2,remark:"",amount:0,address:""}),p=P(!1),D=oe(),i=P(!1),q={status:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA1\u6838\u7ED3\u679C",trigger:"blur"}],remark:[{validator:(e,u,a)=>{u===""||o.status!==2?a(new Error("\u8BF7\u8F93\u5165\u62D2\u7EDD\u7406\u7531")):a()},trigger:"blur"}]},N=()=>h(this,null,function*(){var u,a;yield(u=F.value)==null?void 0:u.validate();const e=I({},o);yield re(e),(a=f.value)==null||a.close(),t("success")}),H=()=>{var e;(e=f.value)==null||e.open()},L=()=>{var e;(e=F.value)==null||e.resetFields()},U=e=>{for(const u in o)e[u]!=null&&e[u]!=null&&(o[u]=e[u])},G=()=>h(this,null,function*(){return typeof window.ethereum=="undefined"?-1:(window.ethereum.on("accountsChanged",function(e){window.location.reload()}),window.ethereum.chainId!==56&&window.ethereum.networkVersion!=="56"?-2:window.ethereum.isHbWallet?window.ethereum.address:(yield window.ethereum.request({method:"eth_requestAccounts"}))[0])}),M=e=>{let u=0,a="";return e==-1?a="\u8BF7\u5728Dapp\u6D4F\u89C8\u5668\u73AF\u5883\u6253\u5F00":e==-2?a="\u8BF7\u5207\u6362\u5230BSC\u94FE":e==null?a="\u8BF7\u89E3\u9501\u94B1\u5305":u=1,{code:u,msg:a}};function j(e,u){return h(this,null,function*(){const a=yield G(),c=M(a),w=localStorage.getItem("transfer_time")||!1;if(w&&parseInt(new Date().getTime())/1e3-parseInt(w)<20)return m.error("\u8F6C\u8D26\u9700\u95F4\u969420\u79D2");const _=new S(new S.providers.HttpProvider(D.config.scan_node));if(!c.code)return m.error(c.msg);if(e<=0)return m.error("\u8F6C\u8D26\u91D1\u989D\u5FC5\u987B\u5927\u4E8E0");const A=yield _.eth.getGasPrice(),E=yield _.eth.getTransactionCount(a,"pending");window.ethereum.request({method:"eth_sendTransaction",params:[{from:a,to:u,gasPrice:A.toString(),gas:"0x7a120",nonce:E.toString(),value:_.utils.toHex(_.utils.toWei(e,"ether")),data:"",chainId:"0x38"}]}).then(d=>{if(console.log("\u7ED3\u679C\uFF1A"+d),d=="null")return m.error("\u64CD\u4F5C\u5931\u8D25\uFF0C\u4F59\u989D\u4E0D\u8DB3");i.value=d,m.success("\u4EA4\u6613\u5DF2\u5E7F\u64AD\uFF0C\u7B49\u5F85\u533A\u5757\u6253\u5305"),localStorage.setItem("transfer_time",parseInt(new Date().getTime()/1e3))}).catch(d=>(console.log("err:"+d),m.error("\u64CD\u4F5C\u5DF2\u53D6\u6D88")))})}const z=()=>h(this,null,function*(){try{p.value=!0,yield j(o.amount,o.address),p.value=!1}catch(e){return console.log(o),m.error(e.message)}finally{p.value=!1}});return r({open:H,setFormData:U}),(e,u)=>{const a=O,c=Q,w=X,_=Y,A=Z,E=ee,d=ue;return g(),v("div",ne,[n(te,{ref_key:"popupRef",ref:f,title:"\u63D0\u73B0\u5BA1\u6838",async:!0,width:"550px",clickModalClose:!1,onConfirm:N,onClose:L},{default:l(()=>[n(d,{ref_key:"formRef",ref:F,model:o,"label-width":"120px",rules:q},{default:l(()=>[n(c,{label:"\u63D0\u73B0\u6570\u91CF",prop:"amount"},{default:l(()=>[n(a,{underline:!1},{default:l(()=>[C(W(o.amount+" BNB"),1)]),_:1})]),_:1}),n(c,{label:"\u5BA1\u6838\u7ED3\u679C",prop:"status"},{default:l(()=>[n(_,{modelValue:o.status,"onUpdate:modelValue":u[0]||(u[0]=y=>o.status=y)},{default:l(()=>[n(w,{label:2},{default:l(()=>[le]),_:1}),n(w,{label:1},{default:l(()=>[ie]),_:1})]),_:1},8,["modelValue"])]),_:1}),o.status==2?(g(),v("div",ce,[n(c,{label:"\u62D2\u7EDD\u7406\u7531",prop:"remark"},{default:l(()=>[k("div",de,[n(A,{type:"textarea",rows:"5",modelValue:o.remark,"onUpdate:modelValue":u[1]||(u[1]=y=>o.remark=y),placeholder:"\u8BF7\u8F93\u5165\u62D2\u7EDD\u7406\u7531\uFF0C\u62D2\u7EDD\u65F6\u5FC5\u586B","show-word-limit":""},null,8,["modelValue"])])]),_:1})])):x("",!0),o.status==1?(g(),v("div",me,[n(c,{label:"\u53D1\u8D77\u8F6C\u8D26"},{default:l(()=>[k("div",fe,[n(E,{type:"success",size:"small",onClick:z,loading:p.value},{default:l(()=>[pe]),_:1},8,["loading"]),_e])]),_:1})])):x("",!0),i.value?(g(),v("div",Fe,[n(c,{label:"Tx"},{default:l(()=>[k("div",De,[n(E,{type:"primary",link:""},{default:l(()=>[C(W(i.value),1)]),_:1})])]),_:1})])):x("",!0)]),_:1},8,["model"])]),_:1},512)])}}});export{Ae as _,ke as a,ve as b};
