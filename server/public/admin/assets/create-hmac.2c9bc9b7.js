import{r as w}from"./inherits.66060a12.js";import{s as B}from"./safe-buffer.d5a81f77.js";import{r as g}from"./cipher-base.698ebf24.js";import{a as R}from"./create-hash.0f02e375.js";import{r as b}from"./ripemd160.b7ffce25.js";import{r as C}from"./sha.js.28d4c0c4.js";var d,m;function L(){if(m)return d;m=1;var c=w(),i=B.exports.Buffer,u=g(),f=i.alloc(128),o=64;function h(s,a){u.call(this,"digest"),typeof a=="string"&&(a=i.from(a)),this._alg=s,this._key=a,a.length>o?a=s(a):a.length<o&&(a=i.concat([a,f],o));for(var n=this._ipad=i.allocUnsafe(o),t=this._opad=i.allocUnsafe(o),r=0;r<o;r++)n[r]=a[r]^54,t[r]=a[r]^92;this._hash=[n]}return c(h,u),h.prototype._update=function(s){this._hash.push(s)},h.prototype._final=function(){var s=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,s]))},d=h,d}var v,l;function M(){if(l)return v;l=1;var c=w(),i=L(),u=g(),f=B.exports.Buffer,o=R(),h=b(),s=C(),a=f.alloc(128);function n(t,r){u.call(this,"digest"),typeof r=="string"&&(r=f.from(r));var e=t==="sha512"||t==="sha384"?128:64;if(this._alg=t,this._key=r,r.length>e){var q=t==="rmd160"?new h:s(t);r=q.update(r).digest()}else r.length<e&&(r=f.concat([r,a],e));for(var _=this._ipad=f.allocUnsafe(e),x=this._opad=f.allocUnsafe(e),p=0;p<e;p++)_[p]=r[p]^54,x[p]=r[p]^92;this._hash=t==="rmd160"?new h:s(t),this._hash.update(_)}return c(n,u),n.prototype._update=function(t){this._hash.update(t)},n.prototype._final=function(){var t=this._hash.digest(),r=this._alg==="rmd160"?new h:s(this._alg);return r.update(this._opad).update(t).digest()},v=function(r,e){return r=r.toLowerCase(),r==="rmd160"||r==="ripemd160"?new n("rmd160",e):r==="md5"?new i(o,e):new n(r,e)},v}export{M as r};
