var v=(y,_,n)=>new Promise((s,i)=>{var m=o=>{try{c(n.next(o))}catch(u){i(u)}},h=o=>{try{c(n.throw(o))}catch(u){i(u)}},c=o=>o.done?s(o.value):Promise.resolve(o.value).then(m,h);c((n=n.apply(y,_)).next())});import{B as U,U as M,y as N,E as P,A as q}from"./element-plus.2d443847.js";import{a as H}from"./role.afc8fa1f.js";import{m as I}from"./menu.7a14fc02.js";import{P as O}from"./index.89655f46.js";import{t as $}from"./index.a71cd9d1.js";import{d as j,s as k,r as p,$ as z,o as G,c as J,U as a,L as f,a as C,n as x}from"./@vue.230e89ba.js";const Q={class:"edit-popup"},oe=j({__name:"auth",emits:["success","close"],setup(y,{expose:_,emit:n}){const s=k(),i=k(),m=k(),h=p(!1),c=p(!0),o=p([]),u=p([]),r=z({id:"",name:"",desc:"",sort:0,menu_id:[]}),b={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},E=()=>{I({page_type:0}).then(e=>{u.value=e.lists,o.value=$(e.lists),x(()=>{w()})})},g=()=>{var t,d;const e=(t=s.value)==null?void 0:t.getCheckedKeys(),l=(d=s.value)==null?void 0:d.getHalfCheckedKeys();return e==null||e.unshift.apply(e,l),e},w=()=>{r.menu_id.forEach(e=>{x(()=>{var l;(l=s.value)==null||l.setChecked(e,!0,!1)})})},A=e=>{const l=u.value;for(let t=0;t<l.length;t++)s.value.store.nodesMap[l[t].id].expanded=e},D=e=>{var l,t;e?(l=s.value)==null||l.setCheckedKeys(o.value.map(d=>d.id)):(t=s.value)==null||t.setCheckedKeys([])},F=()=>v(this,null,function*(){var e,l;yield(e=i.value)==null?void 0:e.validate(),r.menu_id=g(),yield H(r),(l=m.value)==null||l.close(),n("success")}),R=()=>{n("close")},B=()=>{var e;(e=m.value)==null||e.open()},K=e=>v(this,null,function*(){for(const l in r)e[l]!=null&&e[l]!=null&&(r[l]=e[l])});return E(),_({open:B,setFormData:K}),(e,l)=>{const t=U,d=M,V=N,S=P,T=q;return G(),J("div",Q,[a(O,{ref_key:"popupRef",ref:m,title:"\u5206\u914D\u6743\u9650",async:!0,width:"550px",clickModalClose:!0,onConfirm:F,onClose:R},{default:f(()=>[a(T,{class:"ls-form",ref_key:"formRef",ref:i,rules:b,model:r,"label-width":"60px"},{default:f(()=>[a(S,{class:"h-[400px] sm:h-[600px]"},{default:f(()=>[a(V,{label:"\u6743\u9650",prop:"menu_id"},{default:f(()=>[C("div",null,[a(t,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:A}),a(t,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:D}),a(t,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=L=>c.value=L),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),C("div",null,[a(d,{ref_key:"treeRef",ref:s,data:u.value,props:{label:"name",children:"children"},"check-strictly":!c.value,"node-key":"id","default-expand-all":h.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},512)])}}});export{oe as _};
