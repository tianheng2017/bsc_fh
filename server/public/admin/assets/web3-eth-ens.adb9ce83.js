var m=(t,e,r)=>new Promise((n,s)=>{var o=p=>{try{u(r.next(p))}catch(b){s(b)}},i=p=>{try{u(r.throw(p))}catch(b){s(b)}},u=p=>p.done?n(p.value):Promise.resolve(p.value).then(o,i);u((r=r.apply(t,e)).next())});import"./multicodec.e56475ab.js";import{s as M}from"./content-hash.57532ba9.js";import{l as g}from"./web3-core-helpers.1fd5b4bd.js";import{l as x}from"./web3-utils.4b7ab516.js";import{l as N}from"./web3-eth-contract.278927df.js";import{e as E}from"./eth-ens-namehash.1ab11f5d.js";import{l as T}from"./web3-core-promievent.cb88fa51.js";var H={addresses:{main:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",ropsten:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",rinkeby:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",goerli:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},interfaceIds:{addr:"0x3b3b57de",setAddr:"0x3b3b57de",pubkey:"0xc8690233",setPubkey:"0xc8690233",contenthash:"0xbc1c58d1",setContenthash:"0xbc1c58d1",content:"0xd8389dc5",setContent:"0xd8389dc5"}},C=H,O=[{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"resolver",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"label",type:"bytes32"},{name:"owner",type:"address"}],name:"setSubnodeOwner",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"ttl",type:"uint64"}],name:"setTTL",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"ttl",outputs:[{name:"",type:"uint64"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"resolver",type:"address"}],name:"setResolver",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"owner",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"label",type:"bytes32"},{indexed:!1,name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"ttl",type:"uint64"}],name:"NewTTL",type:"event"},{constant:!1,inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"resolver",type:"address"},{internalType:"uint64",name:"ttl",type:"uint64"}],name:"setRecord",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{constant:!0,inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"recordExists",outputs:[{internalType:"bool",name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes32",name:"label",type:"bytes32"},{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"resolver",type:"address"},{internalType:"uint64",name:"ttl",type:"uint64"}],name:"setSubnodeRecord",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],j=O,P=[{constant:!0,inputs:[{name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"},{name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setMultihash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"multihash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],name:"setPubkey",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"content",outputs:[{name:"ret",type:"bytes32"}],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"addr",outputs:[{name:"ret",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"contentType",type:"uint256"},{name:"data",type:"bytes"}],name:"setABI",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"name",outputs:[{name:"ret",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"name",type:"string"}],name:"setName",outputs:[],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes32"}],name:"setContent",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"pubkey",outputs:[{name:"x",type:"bytes32"},{name:"y",type:"bytes32"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"addr",type:"address"}],name:"setAddr",outputs:[],payable:!1,type:"function"},{inputs:[{name:"ensAddr",type:"address"}],payable:!1,type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes32"}],name:"ContentChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!0,name:"contentType",type:"uint256"}],name:"ABIChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"x",type:"bytes32"},{indexed:!1,name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"node",type:"bytes32"},{indexed:!1,name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"},{constant:!0,inputs:[{name:"node",type:"bytes32"}],name:"contenthash",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"node",type:"bytes32"},{name:"hash",type:"bytes"}],name:"setContenthash",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}],I=P,R=N,h=E,d=T,f=g.formatters,v=x,_=j,$=I;function y(t){var e=this;this.ens=t,this.contract=t.checkNetwork().then(function(r){var n=new R(_,r);return n.setProvider(e.ens.eth.currentProvider),n})}y.prototype.owner=function(t,e){return console.warn('Deprecated: Please use the "getOwner" method instead of "owner".'),this.getOwner(t,e)};y.prototype.getOwner=function(t,e){var r=new d(!0);return this.contract.then(function(n){return n.methods.owner(h.hash(t)).call()}).then(function(n){if(typeof e=="function"){e(n,n);return}r.resolve(n)}).catch(function(n){if(typeof e=="function"){e(n,null);return}r.reject(n)}),r.eventEmitter};y.prototype.setOwner=function(t,e,r,n){var s=new d(!0);return this.contract.then(function(o){return o.methods.setOwner(h.hash(t),f.inputAddressFormatter(e)).send(r)}).then(function(o){if(typeof n=="function"){n(o,o);return}s.resolve(o)}).catch(function(o){if(typeof n=="function"){n(o,null);return}s.reject(o)}),s.eventEmitter};y.prototype.getTTL=function(t,e){var r=new d(!0);return this.contract.then(function(n){return n.methods.ttl(h.hash(t)).call()}).then(function(n){if(typeof e=="function"){e(n,n);return}r.resolve(n)}).catch(function(n){if(typeof e=="function"){e(n,null);return}r.reject(n)}),r.eventEmitter};y.prototype.setTTL=function(t,e,r,n){var s=new d(!0);return this.contract.then(function(o){return o.methods.setTTL(h.hash(t),e).send(r)}).then(function(o){if(typeof n=="function"){n(o,o);return}s.resolve(o)}).catch(function(o){if(typeof n=="function"){n(o,null);return}s.reject(o)}),s.eventEmitter};y.prototype.setSubnodeOwner=function(t,e,r,n,s){var o=new d(!0);return v.isHexStrict(e)||(e=v.sha3(e)),this.contract.then(function(i){return i.methods.setSubnodeOwner(h.hash(t),e,f.inputAddressFormatter(r)).send(n)}).then(function(i){if(typeof s=="function"){s(i,i);return}o.resolve(i)}).catch(function(i){if(typeof s=="function"){s(i,null);return}o.reject(i)}),o.eventEmitter};y.prototype.setRecord=function(t,e,r,n,s,o){var i=new d(!0);return this.contract.then(function(u){return u.methods.setRecord(h.hash(t),f.inputAddressFormatter(e),f.inputAddressFormatter(r),n).send(s)}).then(function(u){if(typeof o=="function"){o(u,u);return}i.resolve(u)}).catch(function(u){if(typeof o=="function"){o(u,null);return}i.reject(u)}),i.eventEmitter};y.prototype.setSubnodeRecord=function(t,e,r,n,s,o,i){var u=new d(!0);return v.isHexStrict(e)||(e=v.sha3(e)),this.contract.then(function(p){return p.methods.setSubnodeRecord(h.hash(t),e,f.inputAddressFormatter(r),f.inputAddressFormatter(n),s).send(o)}).then(function(p){if(typeof i=="function"){i(p,p);return}u.resolve(p)}).catch(function(p){if(typeof i=="function"){i(p,null);return}u.reject(p)}),u.eventEmitter};y.prototype.setApprovalForAll=function(t,e,r,n){var s=new d(!0);return this.contract.then(function(o){return o.methods.setApprovalForAll(f.inputAddressFormatter(t),e).send(r)}).then(function(o){if(typeof n=="function"){n(o,o);return}s.resolve(o)}).catch(function(o){if(typeof n=="function"){n(o,null);return}s.reject(o)}),s.eventEmitter};y.prototype.isApprovedForAll=function(t,e,r){var n=new d(!0);return this.contract.then(function(s){return s.methods.isApprovedForAll(f.inputAddressFormatter(t),f.inputAddressFormatter(e)).call()}).then(function(s){if(typeof r=="function"){r(s,s);return}n.resolve(s)}).catch(function(s){if(typeof r=="function"){r(s,null);return}n.reject(s)}),n.eventEmitter};y.prototype.recordExists=function(t,e){var r=new d(!0);return this.contract.then(function(n){return n.methods.recordExists(h.hash(t)).call()}).then(function(n){if(typeof e=="function"){e(n,n);return}r.resolve(n)}).catch(function(n){if(typeof e=="function"){e(n,null);return}r.reject(n)}),r.eventEmitter};y.prototype.resolver=function(t,e){return console.warn('Deprecated: Please use the "getResolver" method instead of "resolver".'),this.getResolver(t,e)};y.prototype.getResolver=function(t,e){var r=this;return this.contract.then(function(n){return n.methods.resolver(h.hash(t)).call()}).then(function(n){var s=new R($,n);if(s.setProvider(r.ens.eth.currentProvider),typeof e=="function"){e(s,s);return}return s}).catch(function(n){if(typeof e=="function"){e(n,null);return}throw n})};y.prototype.setResolver=function(t,e,r,n){var s=new d(!0);return this.contract.then(function(o){return o.methods.setResolver(h.hash(t),f.inputAddressFormatter(e)).send(r)}).then(function(o){if(typeof n=="function"){n(o,o);return}s.resolve(o)}).catch(function(o){if(typeof n=="function"){n(o,null);return}s.reject(o)}),s.eventEmitter};var L=y,S=T,B=E,z=g.errors,w=C.interfaceIds;function c(t){this.registry=t}c.prototype.method=function(t,e,r,n,s){return{call:this.call.bind({ensName:t,methodName:e,methodArguments:r,callback:s,parent:this,outputFormatter:n}),send:this.send.bind({ensName:t,methodName:e,methodArguments:r,callback:s,parent:this})}};c.prototype.call=function(t){var e=this,r=new S,n=this.parent.prepareArguments(this.ensName,this.methodArguments),s=this.outputFormatter||null;return this.parent.registry.getResolver(this.ensName).then(function(o){return m(this,null,function*(){yield e.parent.checkInterfaceSupport(o,e.methodName),e.parent.handleCall(r,o.methods[e.methodName],n,s,t)})}).catch(function(o){if(typeof t=="function"){t(o,null);return}r.reject(o)}),r.eventEmitter};c.prototype.send=function(t,e){var r=this,n=new S,s=this.parent.prepareArguments(this.ensName,this.methodArguments);return this.parent.registry.getResolver(this.ensName).then(function(o){return m(this,null,function*(){yield r.parent.checkInterfaceSupport(o,r.methodName),r.parent.handleSend(n,o.methods[r.methodName],s,t,e)})}).catch(function(o){if(typeof e=="function"){e(o,null);return}n.reject(o)}),n.eventEmitter};c.prototype.handleCall=function(t,e,r,n,s){return e.apply(this,r).call().then(function(o){if(n&&(o=n(o)),typeof s=="function"){s(o,o);return}t.resolve(o)}).catch(function(o){if(typeof s=="function"){s(o,null);return}t.reject(o)}),t};c.prototype.handleSend=function(t,e,r,n,s){return e.apply(this,r).send(n).on("sending",function(){t.eventEmitter.emit("sending")}).on("sent",function(){t.eventEmitter.emit("sent")}).on("transactionHash",function(o){t.eventEmitter.emit("transactionHash",o)}).on("confirmation",function(o,i){t.eventEmitter.emit("confirmation",o,i)}).on("receipt",function(o){t.eventEmitter.emit("receipt",o),t.resolve(o),typeof s=="function"&&s(o,o)}).on("error",function(o){if(t.eventEmitter.emit("error",o),typeof s=="function"){s(o,null);return}t.reject(o)}),t};c.prototype.prepareArguments=function(t,e){var r=B.hash(t);return e.length>0?(e.unshift(r),e):[r]};c.prototype.checkInterfaceSupport=function(t,e){return m(this,null,function*(){if(!!w[e]){var r=!1;try{r=yield t.methods.supportsInterface(w[e]).call()}catch(n){console.warn('Could not verify interface of resolver contract at "'+t.options.address+'". ')}if(!r)throw z.ResolverMethodMissingError(t.options.address,e)}})};var D=c,l=M;function G(t){var e=null,r=null,n=null;if(t&&t.error)return{protocolType:null,decoded:t.error};if(t)try{e=l.decode(t);var s=l.getCodec(t);s==="ipfs-ns"?r="ipfs":s==="swarm-ns"?r="bzz":s==="onion"?r="onion":s==="onion3"?r="onion3":e=t}catch(o){n=o.message}return{protocolType:r,decoded:e,error:n}}function V(t){var e,r,n=!1;if(t){var s=t.match(/^(ipfs|bzz|onion|onion3):\/\/(.*)/)||t.match(/\/(ipfs)\/(.*)/);s&&(r=s[1],e=s[2]);try{if(r==="ipfs")e.length>=4&&(n="0x"+l.fromIpfs(e));else if(r==="bzz")e.length>=4&&(n="0x"+l.fromSwarm(e));else if(r==="onion")e.length===16&&(n="0x"+l.encode("onion",e));else if(r==="onion3")e.length===56&&(n="0x"+l.encode("onion3",e));else throw new Error("Could not encode content hash: unsupported content type")}catch(o){throw o}}return n}var Y={decode:G,encode:V},q=C,J=g.formatters,A=x,K=L,Q=D,F=Y;function a(t){this.eth=t;var e=null;this._detectedAddress=null,this._lastSyncCheck=null,Object.defineProperty(this,"registry",{get:function(){return new K(this)},enumerable:!0}),Object.defineProperty(this,"resolverMethodHandler",{get:function(){return new Q(this.registry)},enumerable:!0}),Object.defineProperty(this,"registryAddress",{get:function(){return e},set:function(r){if(r===null){e=r;return}e=J.inputAddressFormatter(r)},enumerable:!0})}a.prototype.supportsInterface=function(t,e,r){return this.getResolver(t).then(function(n){return A.isHexStrict(e)||(e=A.sha3(e).slice(0,10)),n.methods.supportsInterface(e).call(r)}).catch(function(n){if(typeof r=="function"){r(n,null);return}throw n})};a.prototype.resolver=function(t,e){return this.registry.resolver(t,e)};a.prototype.getResolver=function(t,e){return this.registry.getResolver(t,e)};a.prototype.setResolver=function(t,e,r,n){return this.registry.setResolver(t,e,r,n)};a.prototype.setRecord=function(t,e,r,n,s,o){return this.registry.setRecord(t,e,r,n,s,o)};a.prototype.setSubnodeRecord=function(t,e,r,n,s,o,i){return this.registry.setSubnodeRecord(t,e,r,n,s,o,i)};a.prototype.setApprovalForAll=function(t,e,r,n){return this.registry.setApprovalForAll(t,e,r,n)};a.prototype.isApprovedForAll=function(t,e,r){return this.registry.isApprovedForAll(t,e,r)};a.prototype.recordExists=function(t,e){return this.registry.recordExists(t,e)};a.prototype.setSubnodeOwner=function(t,e,r,n,s){return this.registry.setSubnodeOwner(t,e,r,n,s)};a.prototype.getTTL=function(t,e){return this.registry.getTTL(t,e)};a.prototype.setTTL=function(t,e,r,n){return this.registry.setTTL(t,e,r,n)};a.prototype.getOwner=function(t,e){return this.registry.getOwner(t,e)};a.prototype.setOwner=function(t,e,r,n){return this.registry.setOwner(t,e,r,n)};a.prototype.getAddress=function(t,e){return this.resolverMethodHandler.method(t,"addr",[]).call(e)};a.prototype.setAddress=function(t,e,r,n){return this.resolverMethodHandler.method(t,"setAddr",[e]).send(r,n)};a.prototype.getPubkey=function(t,e){return this.resolverMethodHandler.method(t,"pubkey",[],null,e).call(e)};a.prototype.setPubkey=function(t,e,r,n,s){return this.resolverMethodHandler.method(t,"setPubkey",[e,r]).send(n,s)};a.prototype.getContent=function(t,e){return this.resolverMethodHandler.method(t,"content",[]).call(e)};a.prototype.setContent=function(t,e,r,n){return this.resolverMethodHandler.method(t,"setContent",[e]).send(r,n)};a.prototype.getContenthash=function(t,e){return this.resolverMethodHandler.method(t,"contenthash",[],F.decode).call(e)};a.prototype.setContenthash=function(t,e,r,n){var s;try{s=F.encode(e)}catch(i){var o=new Error("Could not encode "+e+". See docs for supported hash protocols.");if(typeof n=="function"){n(o,null);return}throw o}return this.resolverMethodHandler.method(t,"setContenthash",[s]).send(r,n)};a.prototype.getMultihash=function(t,e){return this.resolverMethodHandler.method(t,"multihash",[]).call(e)};a.prototype.setMultihash=function(t,e,r,n){return this.resolverMethodHandler.method(t,"multihash",[e]).send(r,n)};a.prototype.checkNetwork=function(){return m(this,null,function*(){var t=new Date/1e3;if(!this._lastSyncCheck||t-this._lastSyncCheck>3600){var e=yield this.eth.getBlock("latest"),r=t-e.timestamp;if(r>3600)throw new Error("Network not synced; last block was "+r+" seconds ago");this._lastSyncCheck=t}if(this.registryAddress)return this.registryAddress;if(!this._detectedAddress){var n=yield this.eth.net.getNetworkType(),s=q.addresses[n];if(typeof s=="undefined")throw new Error("ENS is not supported on network "+n);return this._detectedAddress=s,this._detectedAddress}return this._detectedAddress})};var U=a,W=U,se=W;export{se as l};
