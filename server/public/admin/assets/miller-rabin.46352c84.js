import{b as R}from"./bn.js.92292d6f.js";import{b as _}from"./brorand.f18a1e1e.js";var l,w;function y(){if(w)return l;w=1;var d=R.exports,g=_.exports;function f(u){this.rand=u||new g.Rand}return l=f,f.create=function(r){return new f(r)},f.prototype._randbelow=function(r){var e=r.bitLength(),o=Math.ceil(e/8);do var i=new d(this.rand.generate(o));while(i.cmp(r)>=0);return i},f.prototype._randrange=function(r,e){var o=e.sub(r);return r.add(this._randbelow(o))},f.prototype.test=function(r,e,o){var i=r.bitLength(),c=d.mont(r),p=new d(1).toRed(c);e||(e=Math.max(1,i/48|0));for(var a=r.subn(1),v=0;!a.testn(v);v++);for(var b=r.shrn(v),m=a.toRed(c),s=!0;e>0;e--){var n=this._randrange(new d(2),a);o&&o(n);var t=n.toRed(c).redPow(b);if(!(t.cmp(p)===0||t.cmp(m)===0)){for(var h=1;h<v;h++){if(t=t.redSqr(),t.cmp(p)===0)return!1;if(t.cmp(m)===0)break}if(h===v)return!1}}return s},f.prototype.getDivisor=function(r,e){var o=r.bitLength(),i=d.mont(r),c=new d(1).toRed(i);e||(e=Math.max(1,o/48|0));for(var p=r.subn(1),a=0;!p.testn(a);a++);for(var v=r.shrn(a),b=p.toRed(i);e>0;e--){var m=this._randrange(new d(2),p),s=r.gcd(m);if(s.cmpn(1)!==0)return s;var n=m.toRed(i).redPow(v);if(!(n.cmp(c)===0||n.cmp(b)===0)){for(var t=1;t<a;t++){if(n=n.redSqr(),n.cmp(c)===0)return n.fromRed().subn(1).gcd(r);if(n.cmp(b)===0)break}if(t===a)return n=n.redSqr(),n.fromRed().subn(1).gcd(r)}}return!1},l}export{y as r};
