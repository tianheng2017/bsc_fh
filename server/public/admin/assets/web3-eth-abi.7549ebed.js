import{b as _}from"./buffer.b4004db0.js";import{l as v}from"./web3-utils.4b7ab516.js";import{b as m}from"./@ethersproject.5d8623a7.js";var x=_.Buffer,h=v,P=m.AbiCoder,l=m.ParamType,y=new P(function(e,t){return e.match(/^u?int/)&&!Array.isArray(t)&&(!(!!t&&typeof t=="object")||t.constructor.name!=="BN")?t.toString():t});function g(){}var c=function(){};c.prototype.encodeFunctionSignature=function(e){return(typeof e=="function"||typeof e=="object"&&e)&&(e=h._jsonInterfaceMethodToString(e)),h.sha3(e).slice(0,10)};c.prototype.encodeEventSignature=function(e){return(typeof e=="function"||typeof e=="object"&&e)&&(e=h._jsonInterfaceMethodToString(e)),h.sha3(e)};c.prototype.encodeParameter=function(e,t){return this.encodeParameters([e],[t])};c.prototype.encodeParameters=function(e,t){var o=this;return e=o.mapTypes(e),t=t.map(function(r,a){let n=e[a];if(typeof n=="object"&&n.type&&(n=n.type),r=o.formatParam(n,r),typeof n=="string"&&n.includes("tuple")){const p=y._getCoder(l.from(n)),i=(d,s)=>{if(d.name==="array"){if(!d.type.match(/\[(\d+)\]/))return s.map(f=>i(y._getCoder(l.from(d.type.replace("[]",""))),f));const u=parseInt(d.type.match(/\[(\d+)\]/)[1]);if(s.length!==u)throw new Error("Array length does not matches with the given input");return s.map(f=>i(y._getCoder(l.from(d.type.replace(/\[\d+\]/,""))),f))}d.coders.forEach((u,f)=>{u.name==="tuple"?i(u,s[f]):s[f]=o.formatParam(u.name,s[f])})};i(p,r)}return r}),y.encode(e,t)};c.prototype.mapTypes=function(e){var t=this,o=[];return e.forEach(function(r){if(typeof r=="object"&&r.type==="function"&&(r=Object.assign({},r,{type:"bytes24"})),t.isSimplifiedStructFormat(r)){var a=Object.keys(r)[0];o.push(Object.assign(t.mapStructNameAndType(a),{components:t.mapStructToCoderFormat(r[a])}));return}o.push(r)}),o};c.prototype.isSimplifiedStructFormat=function(e){return typeof e=="object"&&typeof e.components=="undefined"&&typeof e.name=="undefined"};c.prototype.mapStructNameAndType=function(e){var t="tuple";return e.indexOf("[]")>-1&&(t="tuple[]",e=e.slice(0,-2)),{type:t,name:e}};c.prototype.mapStructToCoderFormat=function(e){var t=this,o=[];return Object.keys(e).forEach(function(r){if(typeof e[r]=="object"){o.push(Object.assign(t.mapStructNameAndType(r),{components:t.mapStructToCoderFormat(e[r])}));return}o.push({name:r,type:e[r]})}),o};c.prototype.formatParam=function(e,t){const o=new RegExp(/^bytes([0-9]*)$/),r=new RegExp(/^bytes([0-9]*)\[\]$/),a=new RegExp(/^(u?int)([0-9]*)$/),n=new RegExp(/^(u?int)([0-9]*)\[\]$/);if(h.isBN(t)||h.isBigNumber(t))return t.toString(10);if(e.match(r)||e.match(n))return t.map(i=>this.formatParam(e.replace("[]",""),i));let p=e.match(a);if(p){let i=parseInt(p[2]||"256");i/8<t.length&&(t=h.leftPad(t,i))}if(p=e.match(o),p){x.isBuffer(t)&&(t=h.toHex(t));let i=parseInt(p[1]);if(i){let d=i*2;t.substring(0,2)==="0x"&&(d+=2),t.length<d&&(t=h.rightPad(t,i*2))}t.length%2===1&&(t="0x0"+t.substring(2))}return t};c.prototype.encodeFunctionCall=function(e,t){return this.encodeFunctionSignature(e)+this.encodeParameters(e.inputs,t).replace("0x","")};c.prototype.decodeParameter=function(e,t){return this.decodeParameters([e],t)[0]};c.prototype.decodeParameters=function(e,t){return this.decodeParametersWith(e,t,!1)};c.prototype.decodeParametersWith=function(e,t,o){if(e.length>0&&(!t||t==="0x"||t==="0X"))throw new Error("Returned values aren't valid, did it run Out of Gas? You might also see this error if you are not using the correct ABI for the contract you are retrieving data from, requesting data from a block number that does not exist, or querying a node which is not fully synced.");var r=y.decode(this.mapTypes(e),"0x"+t.replace(/0x/i,""),o),a=new g;return a.__length__=0,e.forEach(function(n,p){var i=r[a.__length__];const d=typeof n=="object"&&n.type&&n.type==="string";i=i==="0x"&&!d&&!(typeof n=="string"&&n==="string")?null:i,a[p]=i,(typeof n=="function"||!!n&&typeof n=="object")&&n.name&&(a[n.name]=i),a.__length__++}),a};c.prototype.decodeLog=function(e,t,o){var r=this;o=Array.isArray(o)?o:[o],t=t||"";var a=[],n=[],p=0;e.forEach(function(u,f){u.indexed?(n[f]=["bool","int","uint","address","fixed","ufixed"].find(function(b){return u.type.indexOf(b)!==-1})?r.decodeParameter(u.type,o[p]):o[p],p++):a[f]=u});var i=t,d=i?this.decodeParametersWith(a,i,!0):[],s=new g;return s.__length__=0,e.forEach(function(u,f){s[f]=u.type==="string"?"":null,typeof d[f]!="undefined"&&(s[f]=d[f]),typeof n[f]!="undefined"&&(s[f]=n[f]),u.name&&(s[u.name]=s[f]),s.__length__++}),s};var S=new c,w=S;export{w as l};
