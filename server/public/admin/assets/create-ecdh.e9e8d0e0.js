import{e as c}from"./elliptic.8f0e0a52.js";import{b as h}from"./bn.js.92292d6f.js";var p,y;function m(){if(y)return p;y=1;var a=c,o=h.exports;p=function(t){return new u(t)};var i={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};i.p224=i.secp224r1,i.p256=i.secp256r1=i.prime256v1,i.p192=i.secp192r1=i.prime192v1,i.p384=i.secp384r1,i.p521=i.secp521r1;function u(e){this.curveType=i[e],this.curveType||(this.curveType={name:e}),this.curve=new a.ec(this.curveType.name),this.keys=void 0}u.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},u.prototype.computeSecret=function(e,t,r){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var s=this.curve.keyFromPublic(e).getPublic(),n=s.mul(this.keys.getPrivate()).getX();return f(n,r,this.curveType.byteLength)},u.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic(t==="compressed",!0);return t==="hybrid"&&(r[r.length-1]%2?r[0]=7:r[0]=6),f(r,e)},u.prototype.getPrivateKey=function(e){return f(this.keys.getPrivate(),e)},u.prototype.setPublicKey=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.keys._importPublic(e),this},u.prototype.setPrivateKey=function(e,t){t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t));var r=new o(e);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this};function f(e,t,r){Array.isArray(e)||(e=e.toArray());var s=new Buffer(e);if(r&&s.length<r){var n=new Buffer(r-s.length);n.fill(0),s=Buffer.concat([n,s])}return t?s.toString(t):s}return p}export{m as r};
