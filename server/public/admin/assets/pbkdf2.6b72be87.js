import{c as a}from"./@ethereumjs.af3f5dff.js";import{s as K}from"./safe-buffer.d5a81f77.js";import{a as X}from"./create-hash.0f02e375.js";import{r as J}from"./ripemd160.b7ffce25.js";import{r as Q}from"./sha.js.28d4c0c4.js";var S={},T,U;function V(){if(U)return T;U=1;var u=Math.pow(2,30)-1;return T=function(s,h){if(typeof s!="number")throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if(typeof h!="number")throw new TypeError("Key length not a number");if(h<0||h>u||h!==h)throw new TypeError("Bad key length")},T}var D,L;function Z(){if(L)return D;L=1;var u;if(a.process&&a.process.browser)u="utf-8";else if(a.process&&a.process.version){var s=parseInt(process.version.split(".")[0].slice(1),10);u=s>=6?"utf-8":"binary"}else u="utf-8";return D=u,D}var M,_;function j(){if(_)return M;_=1;var u=K.exports.Buffer;return M=function(s,h,v){if(u.isBuffer(s))return s;if(typeof s=="string")return u.from(s,h);if(ArrayBuffer.isView(s))return u.from(s.buffer);throw new TypeError(v+" must be a string, a Buffer, a typed array or a DataView")},M}var z,C;function G(){if(C)return z;C=1;var u=X(),s=J(),h=Q(),v=K.exports.Buffer,y=V(),w=Z(),m=j(),P=v.alloc(128),B={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function q(o,n,t){var e=p(o),r=o==="sha512"||o==="sha384"?128:64;n.length>r?n=e(n):n.length<r&&(n=v.concat([n,P],r));for(var c=v.allocUnsafe(r+B[o]),i=v.allocUnsafe(r+B[o]),f=0;f<r;f++)c[f]=n[f]^54,i[f]=n[f]^92;var d=v.allocUnsafe(r+t+4);c.copy(d,0,0,r),this.ipad1=d,this.ipad2=c,this.opad=i,this.alg=o,this.blocksize=r,this.hash=e,this.size=B[o]}q.prototype.run=function(o,n){o.copy(n,this.blocksize);var t=this.hash(n);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function p(o){function n(e){return h(o).update(e).digest()}function t(e){return new s().update(e).digest()}return o==="rmd160"||o==="ripemd160"?t:o==="md5"?u:n}function b(o,n,t,e,r){y(t,e),o=m(o,w,"Password"),n=m(n,w,"Salt"),r=r||"sha1";var c=new q(r,o,n.length),i=v.allocUnsafe(e),f=v.allocUnsafe(n.length+4);n.copy(f,0,0,n.length);for(var d=0,l=B[r],A=Math.ceil(e/l),x=1;x<=A;x++){f.writeUInt32BE(x,n.length);for(var H=c.run(f,c.ipad1),R=H,F=1;F<t;F++){R=c.run(R,c.ipad2);for(var E=0;E<l;E++)H[E]^=R[E]}H.copy(i,d),d+=l}return i}return z=b,z}var I,N;function W(){if(N)return I;N=1;var u=K.exports.Buffer,s=V(),h=Z(),v=G(),y=j(),w,m=a.crypto&&a.crypto.subtle,P={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},B=[];function q(t){if(a.process&&!a.process.browser||!m||!m.importKey||!m.deriveBits)return Promise.resolve(!1);if(B[t]!==void 0)return B[t];w=w||u.alloc(8);var e=o(w,w,10,128,t).then(function(){return!0}).catch(function(){return!1});return B[t]=e,e}var p;function b(){return p||(a.process&&a.process.nextTick?p=a.process.nextTick:a.queueMicrotask?p=a.queueMicrotask:a.setImmediate?p=a.setImmediate:p=a.setTimeout,p)}function o(t,e,r,c,i){return m.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then(function(f){return m.deriveBits({name:"PBKDF2",salt:e,iterations:r,hash:{name:i}},f,c<<3)}).then(function(f){return u.from(f)})}function n(t,e){t.then(function(r){b()(function(){e(null,r)})},function(r){b()(function(){e(r)})})}return I=function(t,e,r,c,i,f){typeof i=="function"&&(f=i,i=void 0),i=i||"sha1";var d=P[i.toLowerCase()];if(!d||typeof a.Promise!="function"){b()(function(){var l;try{l=v(t,e,r,c,i)}catch(A){return f(A)}f(null,l)});return}if(s(r,c),t=y(t,h,"Password"),e=y(e,h,"Salt"),typeof f!="function")throw new Error("No callback provided to pbkdf2");n(q(d).then(function(l){return l?o(t,e,r,c,d):v(t,e,r,c,i)}),f)},I}var O;function er(){return O||(O=1,S.pbkdf2=W(),S.pbkdf2Sync=G()),S}export{er as r};
